<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Keuangan - PahamFin</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&family=Poppins:wght@500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563EB',
                        secondary: '#10B981',
                        accent: '#FACC15',
                        bg: '#F9FAFB',
                        textMain: '#1F2937',
                        textLight: '#6B7280',
                    },
                    fontFamily: {
                        sans: ['Open Sans', 'sans-serif'],
                        heading: ['Poppins', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        .active-tool {
            background-color: #EFF6FF;
            color: #2563EB;
            border-left: 4px solid #2563EB;
        }
        .tool-content {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }
        .tool-content.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Dynamic Pie Chart CSS */
        .pie-chart {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            transition: background 0.5s ease;
        }
    </style>
</head>
<body class="bg-bg text-textMain font-sans antialiased overflow-x-hidden flex flex-col min-h-screen">

    <nav class="bg-white/80 backdrop-blur-md fixed w-full z-50 shadow-sm border-b border-gray-100 h-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full">
            <div class="flex justify-between items-center h-full">
                <a href="index.html" class="flex items-center gap-2">
                    <div class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center text-white text-xl font-bold shadow-lg">
                        <i class="fa-solid fa-calculator"></i>
                    </div>
                    <span class="font-heading font-bold text-2xl text-primary">PahamFin</span>
                </a>
                
                <div class="hidden md:flex items-center gap-4">
                    <a href="index.html" class="text-textMain hover:text-primary font-medium transition">Home</a>
                    <a href="index.html#tools" class="px-4 py-2 rounded-full bg-blue-50 text-primary font-bold hover:bg-primary hover:text-white transition">Kembali ke Menu</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="pt-24 flex-grow flex flex-col md:flex-row max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 gap-8 py-8">
        
        <aside class="w-full md:w-1/4 flex-shrink-0">
            <div class="sticky top-28 bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <div class="p-5 bg-gray-50 border-b border-gray-100">
                    <h3 class="font-heading font-bold text-lg">Pilih Alat Simulasi</h3>
                </div>
                <nav class="flex flex-col">
                    <button onclick="switchTool('budget')" id="btn-budget" class="text-left px-5 py-4 hover:bg-gray-50 transition-colors border-b border-gray-100 active-tool flex items-center gap-3">
                        <i class="fa-solid fa-wallet text-xl"></i>
                        <div>
                            <div class="font-bold">Budget Planner</div>
                            <div class="text-xs text-textLight">Multi-Metode</div>
                        </div>
                    </button>
                    <button onclick="switchTool('investasi')" id="btn-investasi" class="text-left px-5 py-4 hover:bg-gray-50 transition-colors border-b border-gray-100 flex items-center gap-3">
                        <i class="fa-solid fa-chart-pie text-xl"></i>
                        <div>
                            <div class="font-bold">Kalkulator Investasi</div>
                            <div class="text-xs text-textLight">Bunga Majemuk</div>
                        </div>
                    </button>
                    <button onclick="switchTool('cicilan')" id="btn-cicilan" class="text-left px-5 py-4 hover:bg-gray-50 transition-colors flex items-center gap-3">
                        <i class="fa-solid fa-percent text-xl"></i>
                        <div>
                            <div class="font-bold">Simulasi Cicilan</div>
                            <div class="text-xs text-textLight">Estimasi Angsuran</div>
                        </div>
                    </button>
                </nav>
            </div>
        </aside>

        <main class="w-full md:w-3/4">

            <div id="budget" class="tool-content active bg-white rounded-3xl p-8 shadow-sm border border-gray-100">
                <div class="flex items-center gap-3 mb-6">
                    <span class="w-10 h-10 rounded-full bg-blue-100 text-primary flex items-center justify-center"><i class="fa-solid fa-wallet"></i></span>
                    <h2 class="font-heading text-2xl font-bold text-gray-900">Budget Planner</h2>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                    <div>
                        <div class="mb-5">
                            <label class="block text-sm font-bold text-gray-700 mb-2">Metode Budgeting</label>
                            <select id="budget-method" onchange="updateBudgetDesc()" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-primary focus:ring-2 focus:ring-blue-100 transition cursor-pointer">
                                <option value="503020">50/30/20 (Populer)</option>
                                <option value="702010">70/20/10 (Prioritas Kebutuhan)</option>
                                <option value="8020">80/20 (Pareto Simpel)</option>
                                <option value="602020">60/20/20 (Seimbang)</option>
                            </select>
                            <p id="budget-desc" class="text-xs text-textLight mt-2 italic">
                                Membagi pendapatan menjadi: 50% Kebutuhan, 30% Keinginan, 20% Tabungan.
                            </p>
                        </div>

                        <label class="block text-sm font-bold text-gray-700 mb-2">Pemasukan Bulanan (IDR)</label>
                        <div class="relative">
                            <span class="absolute left-4 top-3.5 text-gray-500 font-bold">Rp</span>
                            <input type="number" id="budget-income" class="w-full pl-12 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-primary focus:ring-2 focus:ring-blue-100 transition" placeholder="Contoh: 5000000">
                        </div>
                        <button onclick="calculateBudget()" class="w-full mt-6 bg-primary text-white font-bold py-3 rounded-xl hover:bg-blue-700 transition shadow-lg shadow-blue-500/30">
                            Hitung Alokasi
                        </button>
                    </div>

                    <div id="budget-result" class="hidden flex-col items-center justify-center bg-blue-50 rounded-2xl p-6 transition-all">
                        <div id="budget-chart" class="pie-chart mb-6 shadow-lg border-4 border-white"></div>
                        <div id="budget-rows" class="w-full space-y-4"></div>
                    </div>
                    <div id="budget-empty" class="flex flex-col items-center justify-center text-center p-6 text-gray-400">
                        <i class="fa-solid fa-calculator text-6xl mb-4 opacity-20"></i>
                        <p>Pilih metode dan masukkan pendapatan Anda.</p>
                    </div>
                </div>
            </div>

            <div id="investasi" class="tool-content bg-white rounded-3xl p-8 shadow-sm border border-gray-100">
                <div class="flex items-center gap-3 mb-6">
                    <span class="w-10 h-10 rounded-full bg-green-100 text-secondary flex items-center justify-center"><i class="fa-solid fa-chart-line"></i></span>
                    <h2 class="font-heading text-2xl font-bold text-gray-900">Kalkulator Bunga Majemuk</h2>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-2">Modal Awal</label>
                            <input type="number" id="inv-principal" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-secondary transition" placeholder="Rp">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-2">Tabungan Rutin per Bulan</label>
                            <input type="number" id="inv-monthly" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-secondary transition" placeholder="Rp">
                        </div>
                        <div class="flex gap-4">
                            <div class="w-1/2">
                                <label class="block text-sm font-bold text-gray-700 mb-2">Bunga / Tahun (%)</label>
                                <input type="number" id="inv-rate" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-secondary transition" placeholder="%">
                            </div>
                            <div class="w-1/2">
                                <label class="block text-sm font-bold text-gray-700 mb-2">Durasi (Tahun)</label>
                                <input type="number" id="inv-years" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-secondary transition" placeholder="Thn">
                            </div>
                        </div>
                        <button onclick="calculateInvest()" class="w-full mt-2 bg-secondary text-white font-bold py-3 rounded-xl hover:bg-green-600 transition shadow-lg shadow-green-500/30">
                            Hitung Pertumbuhan
                        </button>
                    </div>

                    <div class="bg-gray-50 rounded-2xl p-6 flex flex-col justify-center">
                        <div class="text-center mb-6">
                            <p class="text-sm text-gray-500 font-semibold uppercase tracking-wider">Total Hasil Investasi</p>
                            <h3 id="inv-total" class="font-heading font-extrabold text-3xl text-gray-900 mt-2">Rp 0</h3>
                        </div>
                        <div class="space-y-3">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Total Modal Disetor:</span>
                                <span id="inv-capital" class="font-bold text-gray-800">Rp 0</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Total Bunga Didapat:</span>
                                <span id="inv-interest" class="font-bold text-secondary">Rp 0</span>
                            </div>
                        </div>
                        <div class="mt-6 pt-6 border-t border-gray-200 text-center">
                            <p class="text-xs text-gray-400">Asumsi bunga majemuk dihitung bulanan.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="cicilan" class="tool-content bg-white rounded-3xl p-8 shadow-sm border border-gray-100">
                <div class="flex items-center gap-3 mb-6">
                    <span class="w-10 h-10 rounded-full bg-yellow-100 text-yellow-600 flex items-center justify-center"><i class="fa-solid fa-percent"></i></span>
                    <h2 class="font-heading text-2xl font-bold text-gray-900">Simulasi Cicilan (KPR/KTA)</h2>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-2">Jumlah Pinjaman (Plafon)</label>
                            <input type="number" id="loan-amount" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-accent transition" placeholder="Rp">
                        </div>
                        <div class="flex gap-4">
                            <div class="w-1/2">
                                <label class="block text-sm font-bold text-gray-700 mb-2">Bunga Flat (%)</label>
                                <input type="number" id="loan-rate" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-accent transition" placeholder="Per Tahun">
                            </div>
                            <div class="w-1/2">
                                <label class="block text-sm font-bold text-gray-700 mb-2">Tenor (Tahun)</label>
                                <input type="number" id="loan-years" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-accent transition" placeholder="Tahun">
                            </div>
                        </div>
                        <button onclick="calculateLoan()" class="w-full mt-2 bg-accent text-white font-bold py-3 rounded-xl hover:bg-yellow-500 transition shadow-lg shadow-yellow-500/30">
                            Hitung Cicilan
                        </button>
                    </div>

                    <div class="bg-gray-50 rounded-2xl p-6 flex flex-col justify-center">
                        <div class="text-center mb-6">
                            <p class="text-sm text-gray-500 font-semibold uppercase tracking-wider">Angsuran Per Bulan</p>
                            <h3 id="loan-monthly" class="font-heading font-extrabold text-3xl text-gray-900 mt-2">Rp 0</h3>
                        </div>
                        <div class="space-y-3">
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Total Pinjaman:</span>
                                <span id="loan-principal" class="font-bold text-gray-800">Rp 0</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-gray-600">Total Bunga:</span>
                                <span id="loan-interest" class="font-bold text-yellow-600">Rp 0</span>
                            </div>
                             <div class="flex justify-between text-sm border-t border-gray-200 pt-2 mt-2">
                                <span class="text-gray-800 font-bold">Total Bayar:</span>
                                <span id="loan-total" class="font-bold text-primary">Rp 0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <footer class="bg-[#0F172A] text-gray-300 py-8 border-t border-gray-800 text-center text-sm mt-auto">
        <p>&copy; 2024 PahamFin. Alat simulasi ini hanya sebagai estimasi.</p>
    </footer>

    <script>
        // Formatting Currency IDR
        const formatIDR = (number) => {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(number);
        }

        // --- NAVIGATION LOGIC ---
        function switchTool(toolId) {
            // Sembunyikan semua konten
            document.querySelectorAll('.tool-content').forEach(el => el.classList.remove('active'));
            
            // Reset style tombol sidebar
            document.querySelectorAll('aside button').forEach(el => {
                el.classList.remove('active-tool');
                el.classList.remove('bg-gray-50'); 
                el.classList.remove('border-l-4');
            });
            
            // Tampilkan konten yang dipilih
            const targetContent = document.getElementById(toolId);
            if (targetContent) {
                targetContent.classList.add('active');
            }
            
            // Aktifkan style tombol yang dipilih
            const btn = document.getElementById('btn-' + toolId);
            if (btn) {
                btn.classList.add('active-tool');
            }
        }

        // --- DYNAMIC BUDGET PLANNER ---
        const budgetMethods = {
            '503020': 'Membagi pendapatan menjadi: 50% Kebutuhan, 30% Keinginan, 20% Tabungan.',
            '702010': 'Cocok untuk budget ketat: 70% Biaya Hidup, 20% Tabungan, 10% Dana Darurat/Amal.',
            '8020': 'Metode Pareto: 80% Pengeluaran (Kebutuhan & Keinginan), 20% Tabungan Prioritas.',
            '602020': 'Seimbang: 60% Kebutuhan Pokok, 20% Keinginan/Hiburan, 20% Investasi.'
        };

        function updateBudgetDesc() {
            const method = document.getElementById('budget-method').value;
            document.getElementById('budget-desc').textContent = budgetMethods[method];
        }

        function calculateBudget() {
            const income = parseFloat(document.getElementById('budget-income').value);
            const method = document.getElementById('budget-method').value;
            
            if (!income || income <= 0) {
                alert("Mohon masukkan jumlah pemasukan yang valid.");
                return;
            }

            const container = document.getElementById('budget-rows');
            const chart = document.getElementById('budget-chart');
            container.innerHTML = ''; 

            let data = [];

            if (method === '503020') {
                data = [
                    { label: 'Kebutuhan (50%)', val: income * 0.5, color: 'border-primary', text: 'text-primary', bg: '#2563EB' },
                    { label: 'Keinginan (30%)', val: income * 0.3, color: 'border-accent', text: 'text-yellow-600', bg: '#FACC15' },
                    { label: 'Tabungan (20%)', val: income * 0.2, color: 'border-secondary', text: 'text-secondary', bg: '#10B981' }
                ];
                chart.style.background = `conic-gradient(#2563EB 0% 50%, #FACC15 50% 80%, #10B981 80% 100%)`;

            } else if (method === '702010') {
                data = [
                    { label: 'Biaya Hidup (70%)', val: income * 0.7, color: 'border-primary', text: 'text-primary', bg: '#2563EB' },
                    { label: 'Tabungan (20%)', val: income * 0.2, color: 'border-secondary', text: 'text-secondary', bg: '#10B981' },
                    { label: 'Amal/Darurat (10%)', val: income * 0.1, color: 'border-gray-400', text: 'text-gray-600', bg: '#9CA3AF' }
                ];
                chart.style.background = `conic-gradient(#2563EB 0% 70%, #10B981 70% 90%, #9CA3AF 90% 100%)`;

            } else if (method === '8020') {
                data = [
                    { label: 'Pengeluaran (80%)', val: income * 0.8, color: 'border-primary', text: 'text-primary', bg: '#2563EB' },
                    { label: 'Tabungan (20%)', val: income * 0.2, color: 'border-secondary', text: 'text-secondary', bg: '#10B981' }
                ];
                chart.style.background = `conic-gradient(#2563EB 0% 80%, #10B981 80% 100%)`;

            } else if (method === '602020') {
                data = [
                    { label: 'Kebutuhan (60%)', val: income * 0.6, color: 'border-primary', text: 'text-primary', bg: '#2563EB' },
                    { label: 'Keinginan (20%)', val: income * 0.2, color: 'border-accent', text: 'text-yellow-600', bg: '#FACC15' },
                    { label: 'Investasi (20%)', val: income * 0.2, color: 'border-secondary', text: 'text-secondary', bg: '#10B981' }
                ];
                chart.style.background = `conic-gradient(#2563EB 0% 60%, #FACC15 60% 80%, #10B981 80% 100%)`;
            }

            data.forEach(item => {
                const row = `
                    <div class="flex justify-between items-center p-3 bg-white rounded-lg shadow-sm border-l-4 ${item.color}">
                        <span class="text-sm font-bold text-gray-600">${item.label}</span>
                        <span class="font-bold ${item.text} text-lg">${formatIDR(item.val)}</span>
                    </div>
                `;
                container.innerHTML += row;
            });

            document.getElementById('budget-empty').classList.add('hidden');
            document.getElementById('budget-result').classList.remove('hidden');
            document.getElementById('budget-result').classList.add('flex');
        }

        // --- CALCULATOR 2: INVESTASI ---
        function calculateInvest() {
            const principal = parseFloat(document.getElementById('inv-principal').value) || 0;
            const monthly = parseFloat(document.getElementById('inv-monthly').value) || 0;
            const rate = parseFloat(document.getElementById('inv-rate').value) || 0;
            const years = parseFloat(document.getElementById('inv-years').value) || 0;

            if (years <= 0) return;

            const months = years * 12;
            const monthlyRate = (rate / 100) / 12;
            
            let futureValue = principal;
            let totalContributed = principal;

            for (let i = 0; i < months; i++) {
                futureValue = (futureValue + monthly) * (1 + monthlyRate);
                totalContributed += monthly;
            }

            const totalInterest = futureValue - totalContributed;

            document.getElementById('inv-total').textContent = formatIDR(futureValue);
            document.getElementById('inv-capital').textContent = formatIDR(totalContributed);
            document.getElementById('inv-interest').textContent = formatIDR(totalInterest);
        }

        // --- CALCULATOR 3: LOAN ---
        function calculateLoan() {
            const amount = parseFloat(document.getElementById('loan-amount').value) || 0;
            const rate = parseFloat(document.getElementById('loan-rate').value) || 0;
            const years = parseFloat(document.getElementById('loan-years').value) || 0;

            if (amount <= 0 || years <= 0) return;

            const totalInterest = amount * (rate / 100) * years;
            const totalPayment = amount + totalInterest;
            const months = years * 12;
            const monthlyInstallment = totalPayment / months;

            document.getElementById('loan-monthly').textContent = formatIDR(monthlyInstallment);
            document.getElementById('loan-principal').textContent = formatIDR(amount);
            document.getElementById('loan-interest').textContent = formatIDR(totalInterest);
            document.getElementById('loan-total').textContent = formatIDR(totalPayment);
        }

        // === FITUR PENTING: HANDLE URL HASH ON LOAD ===
        // Ini mendeteksi jika URL diakhiri dengan #budget, #investasi, atau #cicilan
        // dan otomatis membuka tab yang sesuai.
        window.addEventListener('load', () => {
            const hash = window.location.hash.substring(1); // ambil text setelah #
            if (hash && (hash === 'budget' || hash === 'investasi' || hash === 'cicilan')) {
                switchTool(hash);
            }
        });
    </script>
</body>
</html>